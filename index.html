<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Openvas Tasks by vertexclique</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Openvas Tasks</h1>
      <h2 class="project-tagline">Information and history receptor for OpenVAS tasks.</h2>
      <a href="https://github.com/vertexclique/openvas_tasks" class="btn">View on GitHub</a>
      <a href="https://github.com/vertexclique/openvas_tasks/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/vertexclique/openvas_tasks/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="openvas-tasks" class="anchor" href="#openvas-tasks" aria-hidden="true"><span class="octicon octicon-link"></span></a>OpenVAS Tasks</h1>

<p><a href="https://travis-ci.org/vertexclique/openvas_tasks"><img src="https://travis-ci.org/vertexclique/openvas_tasks.svg" alt="Build Status"></a>
<a href="http://badge.fury.io/py/openvas_tasks"><img src="https://badge.fury.io/py/openvas_tasks.svg" alt="PyPI version"></a>
<a href="https://waffle.io/vertexclique/openvas_tasks"><img src="https://badge.waffle.io/vertexclique/openvas_tasks.png?label=ready&amp;title=Ready" alt="Stories in Ready"></a></p>

<p>This project is made for interacting with OpenVAS tasks in OpenVAS tasks database. It is used for acquiring all the tasks data,
history of them, report mappings and results. By default it will use the database on scanner machine and contains ORM mappings mostly (but not all of them). If you want to extend this project we happily accept your PRs.
Default installation of OpenVAS tasks database reside in <code>/var/lib/openvas/mgr/tasks.db</code>.</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>If you are on scanner machine:</p>

<pre><code>import openvas_tasks
b = openvas_tasks.Pool()
b.tasks_count()
</code></pre>

<p>or if you have your own database:</p>

<pre><code>import openvas_tasks
b = openvas_tasks.Pool("/Users/vertexclique/projects/tasks.db")
b.shown_tasks()
</code></pre>

<h1>
<a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h1>

<ul>
<li>
<strong>openvas_tasks.Pool().tasks_data()</strong>

<ul>
<li>fetches all tasks data from db</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().tasks_count()</strong>

<ul>
<li>fetches tasks count from db</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().results_data()</strong>

<ul>
<li>fetches all result data from db</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().results_count()</strong>

<ul>
<li>fetches results count from db</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().shown_tasks()</strong>

<ul>
<li>fetches all shown tasks in any openvas gui (like greenbone)</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().shown_tasks_count()</strong>

<ul>
<li>fetches shown tasks count</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().past_tasks()</strong>

<ul>
<li>fetches all previous and deleted tasks data</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().past_tasks_count()</strong>

<ul>
<li>fetches previous and deleted tasks count</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().task_detail(taskid)</strong>

<ul>
<li>fetches all task detail with specified task id</li>
</ul>
</li>
<li>
<strong>openvas_tasks.Pool().task_detail_count(taskid)</strong>

<ul>
<li>fetches task detail count from db</li>
</ul>
</li>
</ul>

<h2>
<a id="fields-of-objects" class="anchor" href="#fields-of-objects" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fields of Objects</h2>

<p>Object fields of results. Currently:</p>

<ul>
<li>Tasks</li>
<li>Results</li>
<li>Reports</li>
<li>Targets</li>
</ul>

<p>are browsable.</p>

<h3>
<a id="tasks" class="anchor" href="#tasks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tasks</h3>

<ul>
<li>id = <code>id of task</code>
</li>
<li>uuid = <code>uuid of task</code>
</li>
<li>owner = <code>owner id of the task</code>
</li>
<li>name = <code>task name</code>
</li>
<li>hidden = <code>is shown in scan task listing or not?</code>
</li>
<li>time = <code>time for ongoing scan</code>
</li>
<li>comment = <code>comment for the scan</code>
</li>
<li>description = <code>description of the scan</code>
</li>
<li>run_status = <code>run status of the scan</code>
</li>
<li>start_time = <code>start time</code>
</li>
<li>end_time = <code>end time</code>
</li>
<li>config = <code>which configs enabled in this scan</code>
</li>
<li>target = <code>target id</code>
</li>
<li>schedule = <code>schedule if set</code>
</li>
<li>schedule_next_time = <code>next time of the schedule if set</code>
</li>
<li>slave = <code>slave scan runner id</code>
</li>
<li>config_location = <code>config location</code>
</li>
<li>target_location = <code>target location</code>
</li>
<li>schedule_location = <code>schedule location</code>
</li>
<li>slave_location = <code>slave location</code>
</li>
<li>upload_result_count = <code>upload result count</code>
</li>
<li>creation_time = <code>creation time of task</code>
</li>
<li>modification_time = <code>modification time of task</code>
</li>
</ul>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results</h3>

<ul>
<li>id = <code>id of result</code>
</li>
<li>uuid = <code>uuid of result</code>
</li>
<li>task = <code>linked task of the result</code>
</li>
<li>subnet = <code>subnet of the target</code>
</li>
<li>host = <code>host of the result owner target</code>
</li>
<li>port = <code>port of the target that has vulnerability</code>
</li>
<li>nvt = <code>openvas nvt oid</code>
</li>
<li>type = <code>type of vulnerability</code>
</li>
<li>description = <code>description of vulnerability</code>
</li>
<li>report = <code>report id that is linked to specific result</code>
</li>
</ul>

<h3>
<a id="reports" class="anchor" href="#reports" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reports</h3>

<ul>
<li>id = <code>id of report</code>
</li>
<li>uuid = <code>uuid of report</code>
</li>
<li>owner = <code>owner id of report</code>
</li>
<li>hidden = <code>hidden in UI or not</code>
</li>
<li>task = <code>related task</code>
</li>
<li>date = <code>date of it</code>
</li>
<li>start_time = <code>start time of linked scan</code>
</li>
<li>end_time = <code>end time of linked scan task</code>
</li>
<li>nbefile = <code>nbe file path</code>
</li>
<li>comment = <code>comment of report</code>
</li>
<li>scan_run_status = <code>scan run status</code>
</li>
<li>slave_progress = <code>slave progress</code>
</li>
<li>slave_task_uuid = <code>slave task uuid</code>
</li>
<li>highs = <code>high level vulnerability count</code>
</li>
<li>mediums = <code>medium level vulnerability count</code>
</li>
<li>lows = <code>low level vulnerability count</code>
</li>
<li>logs = <code>log level vulnerability count</code>
</li>
<li>fps = <code>FPs</code>
</li>
<li>override_highs = <code>overridden highs</code>
</li>
<li>override_mediums = <code>overridden mediums</code>
</li>
<li>override_lows = <code>overridden lows</code>
</li>
<li>override_logs = <code>overridden logs</code>
</li>
<li>override_fps = <code>overridden FPs</code>
</li>
</ul>

<h3>
<a id="targets" class="anchor" href="#targets" aria-hidden="true"><span class="octicon octicon-link"></span></a>Targets</h3>

<ul>
<li>id = <code>id of the target</code>
</li>
<li>uuid = <code>uuid of the target</code>
</li>
<li>owner = <code>target owner id</code>
</li>
<li>name = <code>name of the target</code>
</li>
<li>hosts = <code>hosts of target</code>
</li>
<li>comment = <code>comment for target</code>
</li>
<li>lsc_credential = <code>local security check credentials</code>
</li>
<li>ssh_port = <code>ssh port</code>
</li>
<li>smb_lsc_credential = <code>smb lsc credentials</code>
</li>
<li>port_range = <code>port range for target whatever the task hits for</code>
</li>
<li>creation_time = <code>creation time for target</code>
</li>
<li>modification_time = <code>modification time of target</code>
</li>
</ul>

<h3>
<a id="configs" class="anchor" href="#configs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configs</h3>

<ul>
<li>id = <code>configs id</code>
</li>
<li>uuid = <code>configs uuid</code>
</li>
<li>owner = <code>config owner id</code>
</li>
<li>name = <code>config name</code>
</li>
<li>nvt_selector = <code>nvt feed selector</code>
</li>
<li>comment = <code>comment for configs</code>
</li>
<li>family_count = <code>family count of nvts</code>
</li>
<li>nvt_count = <code>nvt count</code>
</li>
<li>families_growing = <code>expanded family listings count</code>
</li>
<li>nvts_growing = <code>expanded nvt listings count</code>
</li>
<li>creation_time = <code>creation time for config</code>
</li>
<li>modification_time = <code>modification time for config</code>
</li>
</ul>

<h3>
<a id="alerts" class="anchor" href="#alerts" aria-hidden="true"><span class="octicon octicon-link"></span></a>Alerts</h3>

<ul>
<li>id = <code>id for alert</code>
</li>
<li>uuid = <code>uuid for alert</code>
</li>
<li>owner = <code>owner id for alert</code>
</li>
<li>name = <code>name of alert</code>
</li>
<li>comment = <code>comment of alert</code>
</li>
<li>event = <code>event of alert</code>
</li>
<li>condition = <code>condition of alert</code>
</li>
<li>method = <code>alert method</code>
</li>
<li>filter_col = <code>filter column for multiple alert types</code>
</li>
<li>creation_time = <code>creation time for alert</code>
</li>
<li>modification_time = <code>modification time for alert</code>
</li>
</ul>

<h3>
<a id="slaves" class="anchor" href="#slaves" aria-hidden="true"><span class="octicon octicon-link"></span></a>Slaves</h3>

<p><strong>This object is used in master-slave mode. It won't exist if you have single point installation.</strong></p>

<ul>
<li>id = <code>id for slave</code>
</li>
<li>uuid = <code>uuid for slave</code>
</li>
<li>owner = <code>owner id for slave</code>
</li>
<li>name = <code>name for slave</code>
</li>
<li>comment = <code>comment for slave</code>
</li>
<li>host = <code>host of the slave</code>
</li>
<li>port = <code>port of the slave</code>
</li>
<li>login = <code>login of the slave</code>
</li>
<li>password = <code>password of the slave</code>
</li>
<li>creation_time = <code>creation time for slave</code>
</li>
<li>modification_time = <code>modification time for slave</code>
</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/vertexclique/openvas_tasks">Openvas Tasks</a> is maintained by <a href="https://github.com/vertexclique">vertexclique</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-38825147-5");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>

